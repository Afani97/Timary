{% extends 'timary/base.html' %}

{% block content %}
    <div class="flex flex-col md:flex-row justify-around">
        <div class="bg-gray-50 dark:bg-red-200 shadow-md rounded p-4 md:p-8">
            <h1 class="hidden md:block md:text-3xl">Dashboard</h1>
            <h3 class="md:text-lg">Current total stats:</h3>
            {% include 'partials/_dashboard_stats.html' %}

            <a class="bg-green-600 hover:bg-green-900 text-white md:text-lg font-bold py-1 px-2 md:py-2 md:px-4 rounded"
                href="{% url 'timary:test-async' %}">
                Test Async
            </a>
        </div>
        <div class="md:w-1/3 mt-4 md:mt-0" id="hours-div">
            {% include 'partials/_htmx_post_form.html' with form=new_hours url="/hours/" target="#hours-list" swap="afterbegin" btn_title='Add new hours' id="hours-form" %}
        </div>
    </div>

    <hr class="my-4">

    <ul id="hours-list">
        {% for hour in hours %}
            {% include 'partials/_hour.html' with hour=hour %}
        {% endfor %}
    </ul>

{% endblock %}

{% block js %}
    <script>
        document.body.addEventListener('htmx:afterRequest', (event) => {
            if (event.target.id === "hours-form") {
                document.getElementById("hours-form").reset()
            }
            if (event.target.id === "update-hours-form") {
                htmx.ajax("GET", "/hours/new/", "#hours-div")
            }
        })
    </script>
{% endblock %}
