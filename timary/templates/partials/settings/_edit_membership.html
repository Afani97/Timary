<form
    hx-put="{% url 'timary:update_membership_settings' %}"
    hx-target="this"
    hx-swap="outerHTML"
    hx-vals='js:{membership_tier: get_membership_tier()}'
    class="col-span-3"
>
    {% csrf_token %}
    <div class="flex justify-center space-x-5">
        <div class="shadow stats flex flex-col w-full md:flex-row mb-10 mx-5">
            <div class="stat flex flex-row md:flex-col justify-between">
                <div>
                    <div class="stat-title">Starter</div>
                    <div class="stat-value">$5/m</div>
                    <div class="stat-desc">1 recurring invoice</div>
                </div>
                <div>
                    <div class="stat-actions">
                        <button class="btn btn-sm btn-accent btn-outline" type="button" id="Starter"
                            _="on click call selectSubscriptionPlan(event)">Select</button>
                    </div>
                </div>
            </div>

            <div class="stat flex flex-row md:flex-col content-center justify-between">
                <div>
                    <div class="stat-title">Professional</div>
                    <div class="stat-value">$19/m</div>
                    <div class="stat-desc">2 recurring invoices</div>
                </div>
                <div>
                    <div class="stat-actions">
                        <button class="btn btn-sm btn-accent btn-outline" type="button" id="Professional"
                            _="on click call selectSubscriptionPlan(event)">Select</button>
                    </div>
                </div>
            </div>

            <div class="stat flex flex-row md:flex-col justify-center content-center justify-between">
                <div>
                    <div class="stat-title">Business</div>
                    <div class="stat-value">$49/m</div>
                    <div class="stat-desc">unlimited recurring invoices</div>
                </div>
                <div>
                    <div class="stat-actions">
                        <button class="btn btn-sm btn-accent btn-outline" type="button" id="Business"
                            _="on click call selectSubscriptionPlan(event)">Select</button>
                    </div>
                </div>
            </div>

            <div class="stat flex flex-row md:flex-col justify-center content-center justify-between">
                <div>
                    <div class="stat-title">Fee</div>
                    <div class="stat-value">1% fee</div>
                    <div class="stat-desc">same features as Business</div>
                </div>
                <div>
                    <div class="stat-actions">
                        <button class="btn btn-sm btn-accent btn-outline" type="button" id="Invoice_Fee"
                            _="on click call selectSubscriptionPlan(event)">Select</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="card-actions flex justify-center space-x-4">
        <a class="btn btn-ghost" hx-get="{% url 'timary:settings_partial' setting="membership" %}" hx-target="closest form" hx-swap="outerHTML" _="on click add .loading to me"> Cancel </a>
        <button class="btn btn-primary" type="submit" _="on click add .loading to me"> Update </button>
    </div>

    <script nonce="update-subscription" defer>
        var current_plan = document.getElementById("{{ current_plan }}");
        current_plan.classList.add('plan-chosen');
        current_plan.classList.remove('btn-outline');
        current_plan.innerText = "Chosen";

        function selectSubscriptionPlan(e) {
            e.preventDefault();
            var old_plan = document.querySelector(".plan-chosen");
            old_plan.classList.remove('plan-chosen');
            old_plan.classList.add('btn-outline');
            old_plan.innerText = "Select";

            var plan = document.getElementById(e.target.id);
            plan.classList.add('plan-chosen');
            plan.classList.remove('btn-outline');
            plan.innerText = "Chosen";
        }

        function get_membership_tier(e) {
            return document.querySelector(".plan-chosen").id.toUpperCase();
        }

    </script>
</form>
