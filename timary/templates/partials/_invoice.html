<li class="card shadow-lg bordered px-2 md:px-0" id="{{invoice.slug_title}}">
    <div class="card-body">
        <div class="flex justify-between">

            <div class="flex flex-col md:flex-row justify-between w-full">
                <div>
                    <h2 class="card-title">{{ invoice.title }} - Rate: ${{ invoice.hourly_rate }}</h2>
                    {% if invoice.next_date %}
                        <p class="text-xl">sent {{ invoice.get_invoice_interval_display | lower }} to {{ invoice.email_recipient_name }} ({{invoice.email_recipient}})</p>
                        <p class="text-xl">next date sent is: {{ invoice.next_date }}</p>
                    {% else %}
                        <p class="text-xl">invoice is paused</p>
                    {% endif %}

                    <div class="card-actions">
                        <a class="btn btn-primary btn-sm md:btn-md"
                            hx-get="{% url 'timary:edit_invoice' invoice.id %}"
                            hx-target="closest li"
                            hx-swap="outerHTML"
                            hx-indicator="#{{invoice.slug_title}}">
                            Edit
                        </a>
                        {% include "partials/_spinnr.html" with spinner_id=invoice.slug_title %}
                    </div>
                </div>


                {% if invoice.budget_percentage > 0 %}
                    <div class="hidden md:block">
                        <p class="mb-2 text-center">Budget</p>
                        <div
                            class="radial-progress text-black bg-accent  border-4 border-accent"
                            style="--value:{{ invoice.budget_percentage }}; --thickness: 4px;"
                        >
                            {{ invoice.budget_percentage|floatformat:-2 }}%
                        </div>
                    </div>
                {% endif %}

            </div>
            <div class="dropdown dropdown-left rounded-box ml-10">
                <label tabindex="0" class="btn btn-ghost btn-circle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" /></svg>
                </label>
                <ul tabindex="0" class="menu menu-compact dropdown-content mt-3 p-2 shadow bg-neutral rounded-box w-52">
                    <li>
                        <a
                            hx-get="{% url 'timary:generate_invoice' invoice_id=invoice.id %}"
                            hx-target="closest #{{ invoice.slug_title }}"
                            hx-swap="outerHTML">
                            Generate invoice today
                        </a>
                    </li>
                    <li><a
                        hx-get="{% url 'timary:pause_invoice' invoice_id=invoice.id%}"
                        hx-target="closest #{{ invoice.slug_title }}"
                        hx-swap="outerHTML">
                        {% if invoice.next_date is not None %} Pause {% else %} Unpause {% endif %}
                    </a></li>

                    <li><a
                        hx-get="{% url 'timary:archive_invoice' invoice_id=invoice.id%}"
                        hx-confirm="Are you sure you want to archive this invoice?"
                        hx-target="closest #{{ invoice.slug_title }}"
                        hx-swap="outerHTML">
                        Archive
                    </a></li>

                    <li><a
                        hx-delete="{% url 'timary:delete_invoice' invoice_id=invoice.id %}"
                        hx-confirm="Are you sure you want to delete this invoice?"
                        hx-target="closest #{{ invoice.slug_title }}"
                        hx-swap="outerHTML">
                        Remove
                    </a></li>
                </ul>
            </div>
        </div>


        {% if invoice.user.can_view_invoice_stats %}
            {% if invoice.get_hours_tracked.count > 0 %}
                <div tabindex="0" class="collapse collapse-arrow rounded-md -mx-5">
                    <div class="collapse-title text-xl font-medium">View hours logged this period</div>
                    <div class="collapse-content" id="hours-logged">
                        <div class="flex flex-col md:flex-row justify-between">
                            <ul class="list-disc ml-5">
                                {% for hour in invoice.get_hours_tracked %}
                                    <li class="text-xl">{{ hour.hours|floatformat }} hrs on {{ hour.date_tracked|date:"M jS" }}</li>
                                {% endfor %}
                            </ul>
                            <table class="charts-css column show-labels show-primary-axis show-heading show-data-on-hover">
                                <caption> Hours logged last 6 months </caption>
                                <tbody>
                                    {% for month in invoice.get_last_six_months %}
                                        <tr>
                                            <th scope="row">
                                                {{ month.display }}
                                            </th>
                                            <td style="--size:{{ month.size}};">
                                                <span class="tooltip">{{ month.data }}</span>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            {% endif %}
        {% endif %}
    </div>
</li>
