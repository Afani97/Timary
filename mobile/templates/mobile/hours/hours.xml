<doc xmlns="https://hyperview.org/hyperview">
  <screen>
    <styles>
        {% include 'mobile/base_styles.xml' %}
        {% include 'mobile/header/_header_styles.xml' with jc="space-between" %}
    </styles>
    <body style="Body" id="Body" safe-area="true">
        {% include 'mobile/header/_new_header.xml' with header_title="Hours" url="mobile:new_hours" %}
        <view style="Main">
            {% block hours %}
                <view xmlns="https://hyperview.org/hyperview"
      trigger="refresh"
      href="{% url 'mobile:hours' %}?partial=true"
      id="Hours-List"
      action="replace-inner">
    <view scroll="true" shows-scroll-indicator="false">
        <text style="H1">Current total stats</text>
        {% block hour-stats %}
        <view style="Border" id="Stats" xmlns="https://hyperview.org/hyperview">
            <text style="H3">Hours logged this month</text>
            <text style="H1">{{ current_month.total_hours | floatformat:2 }}</text>
            <text style="H3">estimated earnings: ${{ current_month.total_amount | floatformat:2 }}</text>
        </view>

            {% endblock %}

        <view>
            {% regroup hours by date_tracked as grouped_hours %}
            {% for hours in grouped_hours %}
            <text style="H1">{{ hours.grouper|date:"M. j, Y" }}</text>
            <view style="List">
                {% for hour in hours.list %}
                    {% include 'mobile/hours/_hour.xml' with hour=hour %}
                {% endfor %}
            </view>
            {% endfor %}
        </view>
    </view>
</view>

            {% endblock %}
        </view>
        {% include 'mobile/footer.xml' with active_tab=1 %}

        {# Reload hours screen #}
        <behavior
                trigger="on-event"
                event-name="reload-stats"
                action="replace"
                target="Stats"
                href="{% url 'mobile:hour_stats' %}"
        />
        <behavior
                trigger="on-event"
                event-name="reload-hours"
                action="replace-inner"
                target="Hours-List"
                href="{% url 'mobile:hours' %}?partial=true"
        />
    </body>
  </screen>
  {% include 'mobile/loading_screen.xml' %}
</doc>
